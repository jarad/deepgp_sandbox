% !TEX root = deepgp.tex

\begin{figure}[h]
\centering
\begin{tikzpicture}[
      mycircle/.style={
         circle,
         draw=black,
         % fill=gray,
         fill opacity = 0.3,
         text opacity=1,
         inner sep=1pt,
         minimum size=35pt,
         font=\small},
      myarrow/.style={-Stealth},
      node distance=0.6cm and 1.2cm,
      node/.style={circle, draw, minimum size=35pt}
      ]
\node[mycircle            ] (y1) {$Y_1$};
\node[  circle,right=of y1,minimum size=35pt] (yd) {$\cdots$};
\node[mycircle,right=of yd] (yD) {$Y_D$};

\node[mycircle,above=of y1             ] (hL1) {$H_{L,1}$};
\node[  circle,above=of yd,right=of hL1,minimum size=35pt] (hLd) {$\cdots$};
\node[mycircle,above=of yD,right=of hLd] (hLD) {$H_{L,D_{L}}$};

\node[  circle,above=of hL1             ,minimum size=35pt] (hl1) {$\vdots$};
\node[  circle,above=of hLd,right=of hl1,minimum size=35pt] (hld) {$\cdots$};
\node[  circle,above=of hLD,right=of hld,minimum size=35pt] (hlD) {$\vdots$};

\node[mycircle,above=of hl1             ] (h01) {$H_{0,1}$};
\node[  circle,above=of hld,right=of h01,minimum size=35pt] (h0d) {$\cdots$};
\node[mycircle,above=of hlD,right=of h0d] (h0D) {$H_{0,D_1}$};

\foreach \i/\j in {% start node/end node
      hL1/y1, hL1/yd, hL1/yD,
      hLd/y1, hLd/yd, hLd/yD,
      hLD/y1, hLD/yd, hLD/yD,
      hl1/hL1,hl1/hLd,hl1/hLD,
      hld/hL1,hld/hLd,hld/hLD,
      hlD/hL1,hlD/hLd,hlD/hLD,
      h01/hl1,h01/hld,h01/hlD,
      h0d/hl1,h0d/hld,h0d/hlD,
      h0D/hl1,h0D/hld,h0D/hlD}
       \draw[myarrow] (\i) -- node {} (\j);

\end{tikzpicture}
\begin{minipage}{0.85\textwidth}
\caption{A directed acyclic graph depicting a deep Gaussian process with 
$L$ layers with conditional independences amongst the nodes within a layer. 
Each arrow represents a scalar Gaussian process.
For deep GP regression, $H_0=X$.}
\end{minipage}
\label{fig:deepgp}
\end{figure}